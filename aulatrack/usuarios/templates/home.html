{% extends "base.html" %}
{% load static %}

{% block title %}AulaTrack - Home{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/home.css' %}">
{% endblock %}

{% block content %}
<div>
  <div class="sectionTitle">Tus cursos</div>
  <div class="hint">Acceso rápido a los cursos asignados</div>
</div>

<!-- ===== Cursos asignados al docente ===== -->
<div class="courses">
  {% if cursos_asignados %}
    {% for asignacion in cursos_asignados %}
      <article class="courseCard" tabindex="0">
        <span class="badge">{{ asignacion.curso.año|default:asignacion.año }}</span>

        <div class="title">{{ asignacion.curso.nombre|default:asignacion.nombre }}</div>
        <div class="meta">Aula {{ asignacion.curso.sala|default:asignacion.sala }}</div>

        <div class="meta">Profesor Jefe:
          {% if asignacion.curso.profesor_jefe %}
            {{ asignacion.curso.profesor_jefe.username }}
          {% elif asignacion.profesor_jefe %}
            {{ asignacion.profesor_jefe.username }}
          {% else %}
            Sin asignar
          {% endif %}
        </div>

        <div class="actions">
          <a href="{% url 'curso' asignacion.curso.id|default:asignacion.id %}" class="btn btn-primary">Entrar</a>
        </div>
      </article>
    {% endfor %}
  {% elif user.perfil.role == 'docente' %}
    <p class="muted">No tienes cursos asignados.</p>
  {% endif %}
</div>

<!-- ===== Vista UTP: todos los cursos ===== -->
{% if user.perfil.role == 'utp' %}
  <div style="margin-top: 8px;">
    <div class="sectionTitle">Todos los cursos</div>
    <div class="hint">Vista de UTP: gestión de todos los cursos</div>
  </div>

  <div class="courses">
    {% if cursos_todos %}
      {% for curso in cursos_todos %}
        <article class="courseCard" tabindex="0">
          <span class="badge">{{ curso.año }}</span>

          <div class="title">{{ curso.nombre }}</div>
          <div class="meta">Aula {{ curso.sala }}</div>
          <div class="meta">Profesor Jefe:
            {% if curso.profesor_jefe %}
              {{ curso.profesor_jefe.username }}
            {% else %}
              Sin asignar
            {% endif %}
          </div>

          <div class="actions">
            <a href="{% url 'curso' curso.id %}" class="btn btn-primary">Entrar</a>
            <a href="{% url 'curso_editar' curso.id %}" class="btn btn-ghost">Editar</a>
            <a href="{% url 'curso_eliminar' curso.id %}" class="btn btn-danger">Eliminar</a>
          </div>
        </article>
      {% endfor %}
    {% else %}
      <p class="muted">No hay cursos creados.</p>
    {% endif %}
  </div>
{% endif %}
{% endblock %}
